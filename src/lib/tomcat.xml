<project name="tomcat">

    <description>Build environment for Tomcat web container</description>


    <property name="tomcat.dir" location="${env.CATALINA_HOME}" />

    <!--property name="tomcat.username" value="admin" /-->
    <!--property name="tomcat.password" value="adminadmin" /-->

    <property name="tomcat.host" value="localhost" />
    <property name="tomcat.port" value="8080" />
    <property name="tomcat.port.secure" value="8443" />
    <property name="tomcat.protocol" value="http" />
    <property name="tomcat.protocol.secure" value="https" />
    <property name="tomcat.server" value="${tomcat.host}:${tomcat.port}" />
    <property name="tomcat.server.secure" value="${tomcat.host}:${tomcat.port.secure}" />
    <property name="tomcat.url" value="${tomcat.protocol}://${tomcat.server}" />
    <property name="tomcat.url.secure" value="${tomcat.protocol.secure}://${tomcat.server.secure}" />

    <property name="tomcat.web-manager.context.path" value="manager" />
    <property name="tomcat.web-manager.url" value="${tomcat.url}/${tomcat.web-manager.context.path}" />


    <!-- development libraries -->
    <path id="tomcat.common.jars.path">
        <fileset dir="${tomcat.dir}/common/lib">
            <include name="**/*.jar"/>
        </fileset>
    </path>
    <path id="tomcat.server.jars.path">
        <fileset dir="${tomcat.dir}/server/lib">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <path id="tomcat.jars.path">
        <path refid="tomcat.server.jars.path" />
        <path refid="tomcat.common.jars.path" />
    </path>

    <!-- taskdefs library -->
    <path id="catalina-ant.jar.path">
        <pathelement location="${tomcat.dir}/server/lib/catalina-ant.jar"/>
    </path>


    <taskdef name="deploy" classname="org.apache.catalina.ant.DeployTask" classpathref="catalina-ant.jar.path" />
    <taskdef name="undeploy" classname="org.apache.catalina.ant.UndeployTask" classpathref="catalina-ant.jar.path" />


    <target name="deploy">
        <fail message="MUST DEFINE deploy.war.rel-file PROPERTY" unless="deploy.war.rel-file" />
        <property name="deploy.war.file" location="${deploy.war.rel-file}" />
        <deploy url="${tomcat.web-manager.url}"
                username="${tomcat.username}" password="${tomcat.password}"
                path="/${deploy.context}" war="file:${deploy.war.file}" />
    </target>

    <target name="undeploy">
        <undeploy url="${tomcat.web-manager.url}"
                  username="${tomcat.username}" password="${tomcat.password}"
                  path="/${deploy.context}" />
    </target>

    <target name="redeploy"
            depends="undeploy,deploy"
            description="Undeploy and deploy Web aplication">
    </target>

</project>
